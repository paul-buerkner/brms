<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating Monotonic Effects with brms • brms</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating Monotonic Effects with brms">
<meta property="og:description" content="brms">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.21.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="http://mc-stan.org/rstan" class="external-link">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstanarm" class="external-link">rstanarm</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot" class="external-link">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan" class="external-link">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/loo" class="external-link">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/projpred" class="external-link">projpred</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools" class="external-link">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org" class="external-link">Stan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/mcmc_stan" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/paul-buerkner/brms" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating Monotonic Effects with brms</h1>
                        <h4 data-toc-skip class="author">Paul
Bürkner</h4>
            
            <h4 data-toc-skip class="date">2024-03-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/paul-buerkner/brms/blob/HEAD/vignettes/brms_monotonic.Rmd" class="external-link"><code>vignettes/brms_monotonic.Rmd</code></a></small>
      <div class="hidden name"><code>brms_monotonic.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette is about monotonic effects, a special way of handling
discrete predictors that are on an ordinal or higher scale (Bürkner
&amp; Charpentier, in review). A predictor, which we want to model as
monotonic (i.e., having a monotonically increasing or decreasing
relationship with the response), must either be integer valued or an
ordered factor. As opposed to a continuous predictor, predictor
categories (or integers) are not assumed to be equidistant with respect
to their effect on the response variable. Instead, the distance between
adjacent predictor categories (or integers) is estimated from the data
and may vary across categories. This is realized by parameterizing as
follows: One parameter, <span class="math inline">\(b\)</span>, takes
care of the direction and size of the effect similar to an ordinary
regression parameter. If the monotonic effect is used in a linear model,
<span class="math inline">\(b\)</span> can be interpreted as the
expected average difference between two adjacent categories of the
ordinal predictor. An additional parameter vector, <span class="math inline">\(\zeta\)</span>, estimates the normalized distances
between consecutive predictor categories which thus defines the shape of
the monotonic effect. For a single monotonic predictor, <span class="math inline">\(x\)</span>, the linear predictor term of
observation <span class="math inline">\(n\)</span> looks as follows:</p>
<p><span class="math display">\[\eta_n = b D \sum_{i = 1}^{x_n}
\zeta_i\]</span></p>
<p>The parameter <span class="math inline">\(b\)</span> can take on any
real value, while <span class="math inline">\(\zeta\)</span> is a
simplex, which means that it satisfies <span class="math inline">\(\zeta_i \in [0,1]\)</span> and <span class="math inline">\(\sum_{i = 1}^D \zeta_i = 1\)</span> with <span class="math inline">\(D\)</span> being the number of elements of <span class="math inline">\(\zeta\)</span>. Equivalently, <span class="math inline">\(D\)</span> is the number of categories (or highest
integer in the data) minus 1, since we start counting categories from
zero to simplify the notation.</p>
</div>
<div class="section level2">
<h2 id="a-simple-monotonic-model">A Simple Monotonic Model<a class="anchor" aria-label="anchor" href="#a-simple-monotonic-model"></a>
</h2>
<p>A main application of monotonic effects are ordinal predictors that
can be modeled this way without falsely treating them either as
continuous or as unordered categorical predictors. In Psychology, for
instance, this kind of data is omnipresent in the form of Likert scale
items, which are often treated as being continuous for convenience
without ever testing this assumption. As an example, suppose we are
interested in the relationship of yearly income (in $) and life
satisfaction measured on an arbitrary scale from 0 to 100. Usually,
people are not asked for the exact income. Instead, they are asked to
rank themselves in one of certain classes, say: ‘below 20k’, ‘between
20k and 40k’, ‘between 40k and 100k’ and ‘above 100k’. We use some
simulated data for illustration purposes.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">income_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"below_20"</span>, <span class="st">"20_to_40"</span>, <span class="st">"40_to_100"</span>, <span class="st">"greater_100"</span><span class="op">)</span></span>
<span><span class="va">income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">income_options</span>, <span class="fl">100</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 levels <span class="op">=</span> <span class="va">income_options</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">mean_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">70</span>, <span class="fl">75</span><span class="op">)</span></span>
<span><span class="va">ls</span> <span class="op">&lt;-</span> <span class="va">mean_ls</span><span class="op">[</span><span class="va">income</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">ls</span><span class="op">)</span></span></code></pre></div>
<p>We now proceed with analyzing the data modeling <code>income</code>
as a monotonic effect.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm.html">brm</a></span><span class="op">(</span><span class="va">ls</span> <span class="op">~</span> <span class="fu"><a href="../reference/mo.html">mo</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<p>The summary methods yield</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: ls ~ mo(income) 
   Data: dat (Number of observations: 100) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    30.82      1.38    28.07    33.52 1.00     2259     2479
moincome     14.74      0.63    13.49    16.01 1.00     2223     2209

Monotonic Simplex Parameters:
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
moincome1[1]     0.67      0.04     0.59     0.74 1.00     2110     1960
moincome1[2]     0.26      0.04     0.18     0.34 1.00     3509     2857
moincome1[3]     0.07      0.04     0.01     0.15 1.00     2752     1627

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     6.87      0.51     5.97     7.95 1.00     2743     2307

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit1</span>, variable <span class="op">=</span> <span class="st">"simo"</span>, regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="brms_monotonic_files/figure-html/unnamed-chunk-3-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/conditional_effects.brmsfit.html">conditional_effects</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="brms_monotonic_files/figure-html/unnamed-chunk-3-2.png" width="60%" style="display: block; margin: auto;"></p>
<p>The distributions of the simplex parameter of <code>income</code>, as
shown in the <code>plot</code> method, demonstrate that the largest
difference (about 70% of the difference between minimum and maximum
category) is between the first two categories.</p>
<p>Now, let’s compare of monotonic model with two common alternative
models. (a) Assume <code>income</code> to be continuous:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">$</span><span class="va">income_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">income</span><span class="op">)</span></span>
<span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm.html">brm</a></span><span class="op">(</span><span class="va">ls</span> <span class="op">~</span> <span class="va">income_num</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: ls ~ income_num 
   Data: dat (Number of observations: 100) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept     23.91      2.40    19.12    28.64 1.00     3448     2918
income_num    14.36      0.89    12.61    16.09 1.00     3385     2908

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     9.72      0.69     8.49    11.17 1.00     3933     2787

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>or (b) Assume <code>income</code> to be an unordered factor:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">income</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.treatment</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm.html">brm</a></span><span class="op">(</span><span class="va">ls</span> <span class="op">~</span> <span class="va">income</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: ls ~ income 
   Data: dat (Number of observations: 100) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    30.60      1.40    27.83    33.27 1.00     3147     2789
income2      29.72      1.90    26.01    33.43 1.00     3259     2968
income3      41.49      2.01    37.52    45.45 1.00     3455     2581
income4      44.39      1.97    40.44    48.27 1.00     3534     3110

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     6.86      0.51     5.95     7.95 1.00     3840     2689

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>We can easily compare the fit of the three models using leave-one-out
cross-validation.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/loo.brmsfit.html">loo</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">fit2</span>, <span class="va">fit3</span><span class="op">)</span></span></code></pre></div>
<pre><code>Output of model 'fit1':

Computed from 4000 by 100 log-likelihood matrix.

         Estimate   SE
elpd_loo   -336.2  7.0
p_loo         4.6  0.8
looic       672.5 13.9
------
MCSE of elpd_loo is 0.0.
MCSE and ESS estimates assume MCMC draws (r_eff in [0.6, 1.1]).

All Pareto k estimates are good (k &lt; 0.7).
See help('pareto-k-diagnostic') for details.

Output of model 'fit2':

Computed from 4000 by 100 log-likelihood matrix.

         Estimate   SE
elpd_loo   -370.1  5.6
p_loo         2.5  0.3
looic       740.2 11.2
------
MCSE of elpd_loo is 0.0.
MCSE and ESS estimates assume MCMC draws (r_eff in [0.8, 1.0]).

All Pareto k estimates are good (k &lt; 0.7).
See help('pareto-k-diagnostic') for details.

Output of model 'fit3':

Computed from 4000 by 100 log-likelihood matrix.

         Estimate   SE
elpd_loo   -336.5  7.1
p_loo         4.8  0.8
looic       672.9 14.1
------
MCSE of elpd_loo is 0.0.
MCSE and ESS estimates assume MCMC draws (r_eff in [0.7, 1.3]).

All Pareto k estimates are good (k &lt; 0.7).
See help('pareto-k-diagnostic') for details.

Model comparisons:
     elpd_diff se_diff
fit1   0.0       0.0  
fit3  -0.2       0.2  
fit2 -33.8       6.7  </code></pre>
<p>The monotonic model fits better than the continuous model, which is
not surprising given that the relationship between <code>income</code>
and <code>ls</code> is non-linear. The monotonic and the unordered
factor model have almost identical fit in this example, but this may not
be the case for other data sets.</p>
</div>
<div class="section level2">
<h2 id="setting-prior-distributions">Setting Prior Distributions<a class="anchor" aria-label="anchor" href="#setting-prior-distributions"></a>
</h2>
<p>In the previous monotonic model, we have implicitly assumed that all
differences between adjacent categories were a-priori the same, or
formulated correctly, had the same prior distribution. In the following,
we want to show how to change this assumption. The canonical prior
distribution of a simplex parameter is the Dirichlet distribution, a
multivariate generalization of the beta distribution. It is non-zero for
all valid simplexes (i.e., <span class="math inline">\(\zeta_i \in
[0,1]\)</span> and <span class="math inline">\(\sum_{i = 1}^D \zeta_i =
1\)</span>) and zero otherwise. The Dirichlet prior has a single
parameter <span class="math inline">\(\alpha\)</span> of the same length
as <span class="math inline">\(\zeta\)</span>. The higher <span class="math inline">\(\alpha_i\)</span> the higher the a-priori
probability of higher values of <span class="math inline">\(\zeta_i\)</span>. Suppose that, before looking at
the data, we expected that the same amount of additional money matters
more for people who generally have less money. This translates into a
higher a-priori values of <span class="math inline">\(\zeta_1\)</span>
(difference between ‘below_20’ and ‘20_to_40’) and hence into higher
values of <span class="math inline">\(\alpha_1\)</span>. We choose <span class="math inline">\(\alpha_1 = 2\)</span> and <span class="math inline">\(\alpha_2 = \alpha_3 = 1\)</span>, the latter being
the default value of <span class="math inline">\(\alpha\)</span>. To fit
the model we write:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu"><a href="../reference/brmsfamily.html">dirichlet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"simo"</span>, coef <span class="op">=</span> <span class="st">"moincome1"</span><span class="op">)</span></span>
<span><span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm.html">brm</a></span><span class="op">(</span><span class="va">ls</span> <span class="op">~</span> <span class="fu"><a href="../reference/mo.html">mo</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>            prior <span class="op">=</span> <span class="va">prior4</span>, sample_prior <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The <code>1</code> at the end of <code>"moincome1"</code> may appear
strange when first working with monotonic effects. However, it is
necessary as one monotonic term may be associated with multiple simplex
parameters, if interactions of multiple monotonic variables are included
in the model.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit4</span><span class="op">)</span></span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: ls ~ mo(income) 
   Data: dat (Number of observations: 100) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    30.82      1.41    28.00    33.56 1.00     2900     2690
moincome     14.73      0.65    13.44    16.02 1.00     2680     2550

Monotonic Simplex Parameters:
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
moincome1[1]     0.67      0.04     0.60     0.74 1.00     2559     1907
moincome1[2]     0.26      0.04     0.18     0.35 1.00     3147     2672
moincome1[3]     0.07      0.04     0.01     0.15 1.00     2473     1679

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     6.87      0.52     5.95     7.97 1.00     3016     2827

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>We have used <code>sample_prior = TRUE</code> to also obtain draws
from the prior distribution of <code>simo_moincome1</code> so that we
can visualized it.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit4</span>, variable <span class="op">=</span> <span class="st">"prior_simo"</span>, regex <span class="op">=</span> <span class="cn">TRUE</span>, N <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="brms_monotonic_files/figure-html/unnamed-chunk-11-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>As is visible in the plots, <code>simo_moincome1[1]</code> was
a-priori on average twice as high as <code>simo_moincome1[2]</code> and
<code>simo_moincome1[3]</code> as a result of setting <span class="math inline">\(\alpha_1\)</span> to 2.</p>
</div>
<div class="section level2">
<h2 id="modeling-interactions-of-monotonic-variables">Modeling interactions of monotonic variables<a class="anchor" aria-label="anchor" href="#modeling-interactions-of-monotonic-variables"></a>
</h2>
<p>Suppose, we have additionally asked participants for their age.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">40</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>We are not only interested in the main effect of age but also in the
interaction of income and age. Interactions with monotonic variables can
be specified in the usual way using the <code>*</code> operator:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm.html">brm</a></span><span class="op">(</span><span class="va">ls</span> <span class="op">~</span> <span class="fu"><a href="../reference/mo.html">mo</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span><span class="op">*</span><span class="va">age</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit5</span><span class="op">)</span></span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: ls ~ mo(income) * age 
   Data: dat (Number of observations: 100) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept       38.23      6.22    27.32    51.46 1.00     1271     2044
age             -0.18      0.15    -0.50     0.08 1.00     1249     1768
moincome        11.31      2.75     5.66    16.32 1.00     1120     2224
moincome:age     0.09      0.07    -0.04     0.23 1.00     1145     2134

Monotonic Simplex Parameters:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
moincome1[1]         0.69      0.11     0.46     0.90 1.00     1593     1525
moincome1[2]         0.24      0.10     0.03     0.44 1.00     1677     1729
moincome1[3]         0.07      0.05     0.00     0.19 1.00     2570     1713
moincome:age1[1]     0.47      0.25     0.03     0.90 1.00     1702     2001
moincome:age1[2]     0.33      0.22     0.01     0.82 1.00     2035     2170
moincome:age1[3]     0.20      0.17     0.01     0.67 1.00     1921     2258

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     6.84      0.51     5.92     7.92 1.00     3078     2408

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/conditional_effects.brmsfit.html">conditional_effects</a></span><span class="op">(</span><span class="va">fit5</span>, <span class="st">"income:age"</span><span class="op">)</span></span></code></pre></div>
<p><img src="brms_monotonic_files/figure-html/unnamed-chunk-14-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="modelling-monotonic-group-level-effects">Modelling Monotonic Group-Level Effects<a class="anchor" aria-label="anchor" href="#modelling-monotonic-group-level-effects"></a>
</h2>
<p>Suppose that the 100 people in our sample data were drawn from 10
different cities; 10 people per city. Thus, we add an identifier for
<code>city</code> to the data and add some city-related variation to
<code>ls</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span><span class="op">$</span><span class="va">city</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">var_city</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">ls</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">ls</span> <span class="op">+</span> <span class="va">var_city</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">city</span><span class="op">]</span></span></code></pre></div>
<p>With the following code, we fit a multilevel model assuming the
intercept and the effect of <code>income</code> to vary by city:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm.html">brm</a></span><span class="op">(</span><span class="va">ls</span> <span class="op">~</span> <span class="fu"><a href="../reference/mo.html">mo</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span><span class="op">*</span><span class="va">age</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="../reference/mo.html">mo</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span> <span class="op">|</span> <span class="va">city</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit6</span><span class="op">)</span></span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: ls ~ mo(income) * age + (mo(income) | city) 
   Data: dat (Number of observations: 100) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Multilevel Hyperparameters:
~city (Number of levels: 10) 
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)              12.95      3.78     7.52    21.13 1.00     1210     2249
sd(moincome)                1.56      1.11     0.08     4.22 1.00      938     1982
cor(Intercept,moincome)    -0.26      0.46    -0.93     0.80 1.00     2598     1934

Regression Coefficients:
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept       43.42      9.03    26.47    61.52 1.00     1208     1850
age             -0.29      0.19    -0.65     0.06 1.00     1214     2517
moincome         9.22      3.43     2.83    15.70 1.00     1194     2199
moincome:age     0.13      0.08    -0.02     0.29 1.00     1186     2272

Monotonic Simplex Parameters:
                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
moincome1[1]         0.58      0.16     0.18     0.84 1.00     1441     1566
moincome1[2]         0.32      0.15     0.06     0.67 1.00     1691     1881
moincome1[3]         0.10      0.08     0.01     0.32 1.00     2076     1937
moincome:age1[1]     0.59      0.23     0.06     0.93 1.00     1596     2033
moincome:age1[2]     0.27      0.19     0.01     0.74 1.00     2203     2364
moincome:age1[3]     0.15      0.15     0.00     0.60 1.00     2305     2108

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     6.39      0.52     5.45     7.49 1.00     3000     3133

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>reveals that the effect of <code>income</code> varies only little
across cities. For the present data, this is not overly surprising given
that, in the data simulations, we assumed <code>income</code> to have
the same effect across cities.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Bürkner P. C. &amp; Charpentier, E. (in review). <a href="https://psyarxiv.com/9qkhj/" class="external-link">Monotonic Effects: A Principled
Approach for Including Ordinal Predictors in Regression Models</a>.
<em>PsyArXiv preprint</em>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Paul-Christian Bürkner.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
