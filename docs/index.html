<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bayesian Regression Models using Stan • brms</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Bayesian Regression Models using Stan">
<meta name="description" content="Fit Bayesian generalized (non-)linear multivariate multilevel models using Stan for full Bayesian inference. A wide range of distributions and link functions are supported, allowing users to fit -- among others -- linear, robust linear, count data, survival, response times, ordinal, zero-inflated, hurdle, and even self-defined mixture models all in a multilevel context. Further modeling options include both theory-driven and data-driven non-linear terms, auto-correlation structures, censoring and truncation, meta-analytic standard errors, and quite a few more. In addition, all parameters of the response distribution can be predicted in order to perform distributional regression. Prior specifications are flexible and explicitly encourage users to apply prior distributions that actually reflect their prior knowledge. Models can easily be evaluated and compared using several methods assessing posterior or prior predictions. References: Bürkner (2017) &lt;doi:10.18637/jss.v080.i01&gt;; Bürkner (2018) &lt;doi:10.32614/RJ-2018-017&gt;; Bürkner (2021) &lt;doi:10.18637/jss.v100.i05&gt;; Carpenter et al. (2017) &lt;doi:10.18637/jss.v076.i01&gt;.">
<meta property="og:description" content="Fit Bayesian generalized (non-)linear multivariate multilevel models using Stan for full Bayesian inference. A wide range of distributions and link functions are supported, allowing users to fit -- among others -- linear, robust linear, count data, survival, response times, ordinal, zero-inflated, hurdle, and even self-defined mixture models all in a multilevel context. Further modeling options include both theory-driven and data-driven non-linear terms, auto-correlation structures, censoring and truncation, meta-analytic standard errors, and quite a few more. In addition, all parameters of the response distribution can be predicted in order to perform distributional regression. Prior specifications are flexible and explicitly encourage users to apply prior distributions that actually reflect their prior knowledge. Models can easily be evaluated and compared using several methods assessing posterior or prior predictions. References: Bürkner (2017) &lt;doi:10.18637/jss.v080.i01&gt;; Bürkner (2018) &lt;doi:10.32614/RJ-2018-017&gt;; Bürkner (2021) &lt;doi:10.18637/jss.v100.i05&gt;; Carpenter et al. (2017) &lt;doi:10.18637/jss.v076.i01&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">brms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.22.12</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/brms_customfamilies.html">Define Custom Response Distributions with brms</a></li>
    <li><a class="dropdown-item" href="articles/brms_distreg.html">Estimating Distributional Models with brms</a></li>
    <li><a class="dropdown-item" href="articles/brms_families.html">Parameterization of Response Distributions in brms</a></li>
    <li><a class="dropdown-item" href="articles/brms_missings.html">Handle Missing Values with brms</a></li>
    <li><a class="dropdown-item" href="articles/brms_monotonic.html">Estimating Monotonic Effects with brms</a></li>
    <li><a class="dropdown-item" href="articles/brms_multivariate.html">Estimating Multivariate Models with brms</a></li>
    <li><a class="dropdown-item" href="articles/brms_nonlinear.html">Estimating Non-Linear Models with brms</a></li>
    <li><a class="dropdown-item" href="articles/brms_phylogenetics.html">Estimating Phylogenetic Multilevel Models with brms</a></li>
    <li><a class="dropdown-item" href="articles/brms_threading.html">Running brms models with within-chain parallelization</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/paul-buerkner/brms/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="brms">brms<a class="anchor" aria-label="anchor" href="#brms"></a>
</h1></div>
<p><a href="https://github.com/paul-buerkner/brms/actions" class="external-link"><img src="https://github.com/paul-buerkner/brms/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a> <a href="https://app.codecov.io/github/paul-buerkner/brms?branch=master" class="external-link"><img src="https://codecov.io/github/paul-buerkner/brms/coverage.svg?branch=master" alt="Coverage Status"></a> <a href="https://cran.r-project.org/package=brms" class="external-link"><img src="https://www.r-pkg.org/badges/version/brms" alt="CRAN Version"></a> <a href="https://CRAN.R-project.org/package=brms" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/brms?color=brightgreen" alt="Downloads"></a></p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <strong>brms</strong> package provides an interface to fit Bayesian generalized (non-)linear multivariate multilevel models using Stan, which is a C++ package for performing full Bayesian inference (see <a href="https://mc-stan.org/" class="external-link uri">https://mc-stan.org/</a>). The formula syntax is very similar to that of the package lme4 to provide a familiar and simple interface for performing regression analyses. A wide range of response distributions are supported, allowing users to fit – among others – linear, robust linear, count data, survival, response times, ordinal, zero-inflated, and even self-defined mixture models all in a multilevel context. Further modeling options include non-linear and smooth terms, auto-correlation structures, censored data, missing value imputation, and quite a few more. In addition, all parameters of the response distribution can be predicted in order to perform distributional regression. Multivariate models (i.e., models with multiple response variables) can be fit, as well. Prior specifications are flexible and explicitly encourage users to apply prior distributions that actually reflect their beliefs. Model fit can easily be assessed and compared with posterior predictive checks, cross-validation, and Bayes factors.</p>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<ul>
<li>
<a href="https://doi.org/10.18637/jss.v080.i01" class="external-link">Introduction to brms</a> (Journal of Statistical Software)</li>
<li>
<a href="https://journal.r-project.org/archive/2018/RJ-2018-017/index.html" class="external-link">Advanced multilevel modeling with brms</a> (The R Journal)</li>
<li>
<a href="https://paulbuerkner.com/brms/" class="external-link">Website</a> (Website of brms with documentation and vignettes)</li>
<li>
<a href="http://paulbuerkner.com/software/brms-blogposts.html" class="external-link">Blog posts</a> (List of blog posts about brms)</li>
<li>
<a href="https://discourse.mc-stan.org/" class="external-link">Ask a question</a> (Stan Forums on Discourse)</li>
<li>
<a href="https://github.com/paul-buerkner/brms/issues" class="external-link">Open an issue</a> (GitHub issues for bug reports and feature requests)</li>
</ul>
</div>
<div class="section level2">
<h2 id="how-to-use-brms">How to use brms<a class="anchor" aria-label="anchor" href="#how-to-use-brms"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms" class="external-link">brms</a></span><span class="op">)</span></span></code></pre></div>
<p>As a simple example, we use poisson regression to model the seizure counts in epileptic patients to investigate whether the treatment (represented by variable <code>Trt</code>) can reduce the seizure counts and whether the effect of the treatment varies with the (standardized) baseline number of seizures a person had before treatment (variable <code>zBase</code>). As we have multiple observations per person, a group-level intercept is incorporated to account for the resulting dependency in the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/brm.html">brm</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">zAge</span> <span class="op">+</span> <span class="va">zBase</span> <span class="op">*</span> <span class="va">Trt</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">patient</span><span class="op">)</span>,</span>
<span>            data <span class="op">=</span> <span class="va">epilepsy</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The results (i.e., posterior draws) can be investigated using</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: poisson </span></span>
<span><span class="co">#&gt;   Links: mu = log </span></span>
<span><span class="co">#&gt; Formula: count ~ zAge + zBase * Trt + (1 | patient) </span></span>
<span><span class="co">#&gt;    Data: epilepsy (Number of observations: 236) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multilevel Hyperparameters:</span></span>
<span><span class="co">#&gt; ~patient (Number of levels: 59) </span></span>
<span><span class="co">#&gt;               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sd(Intercept)     0.59      0.07     0.46     0.74 1.01      566     1356</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept      1.78      0.12     1.55     2.01 1.00      771     1595</span></span>
<span><span class="co">#&gt; zAge           0.09      0.09    -0.08     0.27 1.00      590     1302</span></span>
<span><span class="co">#&gt; zBase          0.71      0.12     0.47     0.96 1.00      848     1258</span></span>
<span><span class="co">#&gt; Trt1          -0.27      0.16    -0.60     0.05 1.01      749     1172</span></span>
<span><span class="co">#&gt; zBase:Trt1     0.05      0.17    -0.30     0.38 1.00      833     1335</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>On the top of the output, some general information on the model is given, such as family, formula, number of iterations and chains. Next, group-level effects are displayed separately for each grouping factor in terms of standard deviations and (in case of more than one group-level effect per grouping factor; not displayed here) correlations between group-level effects. On the bottom of the output, population-level effects (i.e. regression coefficients) are displayed. If incorporated, autocorrelation effects and family specific parameters (e.g., the residual standard deviation ‘sigma’ in normal models) are also given.</p>
<p>In general, every parameter is summarized using the mean (‘Estimate’) and the standard deviation (‘Est.Error’) of the posterior distribution as well as two-sided 95% credible intervals (‘l-95% CI’ and ‘u-95% CI’) based on quantiles. We see that the coefficient of <code>Trt</code> is negative with a zero overlapping 95%-CI. This indicates that, on average, the treatment may reduce seizure counts by some amount but the evidence based on the data and applied model is not very strong and still insufficient by standard decision rules. Further, we find little evidence that the treatment effect varies with the baseline number of seizures.</p>
<p>The last three values (‘ESS_bulk’, ‘ESS_tail’, and ‘Rhat’) provide information on how well the algorithm could estimate the posterior distribution of this parameter. If ‘Rhat’ is considerably greater than 1, the algorithm has not yet converged and it is necessary to run more iterations and / or set stronger priors.</p>
<p>To visually investigate the chains as well as the posterior distributions, we can use the <code>plot</code> method. If we just want to see results of the regression coefficients of <code>Trt</code> and <code>zBase</code>, we go for</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit1</span>, variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b_Trt1"</span>, <span class="st">"b_zBase"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>A more detailed investigation can be performed by running <code>launch_shinystan(fit1)</code>. To better understand the relationship of the predictors with the response, I recommend the <code>conditional_effects</code> method:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="reference/conditional_effects.brmsfit.html">conditional_effects</a></span><span class="op">(</span><span class="va">fit1</span>, effects <span class="op">=</span> <span class="st">"zBase:Trt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-conditional_effects-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>This method uses some prediction functionality behind the scenes, which can also be called directly. Suppose that we want to predict responses (i.e. seizure counts) of a person in the treatment group (<code>Trt = 1</code>) and in the control group (<code>Trt = 0</code>) with average age and average number of previous seizures. Than we can use</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, zAge <span class="op">=</span> <span class="fl">0</span>, zBase <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit1</span>, newdata <span class="op">=</span> <span class="va">newdata</span>, re_formula <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Estimate Est.Error Q2.5 Q97.5</span></span>
<span><span class="co">#&gt; [1,]  5.91200  2.494857    2    11</span></span>
<span><span class="co">#&gt; [2,]  4.57325  2.166058    1     9</span></span></code></pre></div>
<p>We need to set <code>re_formula = NA</code> in order not to condition of the group-level effects. While the <code>predict</code> method returns predictions of the responses, the <code>fitted</code> method returns predictions of the regression line.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">fit1</span>, newdata <span class="op">=</span> <span class="va">newdata</span>, re_formula <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Estimate Est.Error     Q2.5    Q97.5</span></span>
<span><span class="co">#&gt; [1,] 5.945276 0.7075160 4.696257 7.450011</span></span>
<span><span class="co">#&gt; [2,] 4.540081 0.5343471 3.579757 5.665132</span></span></code></pre></div>
<p>Both methods return the same estimate (up to random error), while the latter has smaller variance, because the uncertainty in the regression line is smaller than the uncertainty in each response. If we want to predict values of the original data, we can just leave the <code>newdata</code> argument empty.</p>
<p>Suppose, we want to investigate whether there is overdispersion in the model, that is residual variation not accounted for by the response distribution. For this purpose, we include a second group-level intercept that captures possible overdispersion.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/brm.html">brm</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">zAge</span> <span class="op">+</span> <span class="va">zBase</span> <span class="op">*</span> <span class="va">Trt</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">patient</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">obs</span><span class="op">)</span>,</span>
<span>            data <span class="op">=</span> <span class="va">epilepsy</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can then go ahead and compare both models via approximate leave-one-out (LOO) cross-validation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/loo.brmsfit.html">loo</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">fit2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Output of model 'fit1':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computed from 4000 by 236 log-likelihood matrix.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          Estimate   SE</span></span>
<span><span class="co">#&gt; elpd_loo   -671.7 36.6</span></span>
<span><span class="co">#&gt; p_loo        94.3 14.2</span></span>
<span><span class="co">#&gt; looic      1343.4 73.2</span></span>
<span><span class="co">#&gt; ------</span></span>
<span><span class="co">#&gt; MCSE of elpd_loo is NA.</span></span>
<span><span class="co">#&gt; MCSE and ESS estimates assume MCMC draws (r_eff in [0.4, 2.0]).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pareto k diagnostic values:</span></span>
<span><span class="co">#&gt;                          Count Pct.    Min. ESS</span></span>
<span><span class="co">#&gt; (-Inf, 0.7]   (good)     228   96.6%   157     </span></span>
<span><span class="co">#&gt;    (0.7, 1]   (bad)        7    3.0%   &lt;NA&gt;    </span></span>
<span><span class="co">#&gt;    (1, Inf)   (very bad)   1    0.4%   &lt;NA&gt;    </span></span>
<span><span class="co">#&gt; See help('pareto-k-diagnostic') for details.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output of model 'fit2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computed from 4000 by 236 log-likelihood matrix.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          Estimate   SE</span></span>
<span><span class="co">#&gt; elpd_loo   -596.8 14.0</span></span>
<span><span class="co">#&gt; p_loo       109.7  7.2</span></span>
<span><span class="co">#&gt; looic      1193.6 28.1</span></span>
<span><span class="co">#&gt; ------</span></span>
<span><span class="co">#&gt; MCSE of elpd_loo is NA.</span></span>
<span><span class="co">#&gt; MCSE and ESS estimates assume MCMC draws (r_eff in [0.4, 1.7]).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pareto k diagnostic values:</span></span>
<span><span class="co">#&gt;                          Count Pct.    Min. ESS</span></span>
<span><span class="co">#&gt; (-Inf, 0.7]   (good)     172   72.9%   83      </span></span>
<span><span class="co">#&gt;    (0.7, 1]   (bad)       56   23.7%   &lt;NA&gt;    </span></span>
<span><span class="co">#&gt;    (1, Inf)   (very bad)   8    3.4%   &lt;NA&gt;    </span></span>
<span><span class="co">#&gt; See help('pareto-k-diagnostic') for details.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model comparisons:</span></span>
<span><span class="co">#&gt;      elpd_diff se_diff</span></span>
<span><span class="co">#&gt; fit2   0.0       0.0  </span></span>
<span><span class="co">#&gt; fit1 -74.9      27.2</span></span></code></pre></div>
<p>The <code>loo</code> output when comparing models is a little verbose. We first see the individual LOO summaries of the two models and then the comparison between them. Since higher <code>elpd</code> (i.e., expected log posterior density) values indicate better fit, we see that the model accounting for overdispersion (i.e., <code>fit2</code>) fits substantially better. However, we also see in the individual LOO outputs that there are several problematic observations for which the approximations may have not have been very accurate. To deal with this appropriately, we need to fall back to other methods such as <code>reloo</code> or <code>kfold</code> but this requires the model to be refit several times which takes too long for the purpose of a quick example. The post-processing methods we have shown above are just the tip of the iceberg. For a full list of methods to apply on fitted model objects, type <code>methods(class = "brmsfit")</code>.</p>
</div>
<div class="section level2">
<h2 id="citing-brms-and-related-software">Citing brms and related software<a class="anchor" aria-label="anchor" href="#citing-brms-and-related-software"></a>
</h2>
<p>Developing and maintaining open source software is an important yet often underappreciated contribution to scientific progress. Thus, whenever you are using open source software (or software in general), please make sure to cite it appropriately so that developers get credit for their work.</p>
<p>When using brms, please cite one or more of the following publications:</p>
<ul>
<li>Bürkner P. C. (2017). brms: An R Package for Bayesian Multilevel Models using Stan. <em>Journal of Statistical Software</em>. 80(1), 1-28. doi.org/10.18637/jss.v080.i01</li>
<li>Bürkner P. C. (2018). Advanced Bayesian Multilevel Modeling with the R Package brms. <em>The R Journal</em>. 10(1), 395-411. doi.org/10.32614/RJ-2018-017</li>
<li>Bürkner P. C. (2021). Bayesian Item Response Modeling in R with brms and Stan. <em>Journal of Statistical Software</em>, 100(5), 1-54. doi.org/10.18637/jss.v100.i05</li>
</ul>
<p>As brms is a high-level interface to Stan, please additionally cite Stan (see also <a href="https://mc-stan.org/users/citations/" class="external-link uri">https://mc-stan.org/users/citations/</a>):</p>
<ul>
<li>Stan Development Team. YEAR. Stan Modeling Language Users Guide and Reference Manual, VERSION. <a href="https://mc-stan.org" class="external-link uri">https://mc-stan.org</a>
</li>
<li>Carpenter B., Gelman A., Hoffman M. D., Lee D., Goodrich B., Betancourt M., Brubaker M., Guo J., Li P., and Riddell A. (2017). Stan: A probabilistic programming language. <em>Journal of Statistical Software</em>. 76(1). doi.org/10.18637/jss.v076.i01</li>
</ul>
<p>Further, brms relies on several other R packages and, of course, on R itself. To find out how to cite R and its packages, use the <code>citation</code> function. There are some features of brms which specifically rely on certain packages. The <strong>rstan</strong> package together with <strong>Rcpp</strong> makes Stan conveniently accessible in R. Visualizations and posterior-predictive checks are based on <strong>bayesplot</strong> and <strong>ggplot2</strong>. Approximate leave-one-out cross-validation using <code>loo</code> and related methods is done via the <strong>loo</strong> package. Marginal likelihood based methods such as <code>bayes_factor</code> are realized by means of the <strong>bridgesampling</strong> package. Splines specified via the <code>s</code> and <code>t2</code> functions rely on <strong>mgcv</strong>. If you use some of these features, please also consider citing the related packages.</p>
</div>
<div class="section level2">
<h2 id="faq">FAQ<a class="anchor" aria-label="anchor" href="#faq"></a>
</h2>
<div class="section level3">
<h3 id="how-do-i-install-brms">How do I install brms?<a class="anchor" aria-label="anchor" href="#how-do-i-install-brms"></a>
</h3>
<p>To install the latest release version from CRAN use</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"brms"</span><span class="op">)</span></span></code></pre></div>
<p>The current developmental version can be downloaded from GitHub via</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"paul-buerkner/brms"</span><span class="op">)</span></span></code></pre></div>
<p>Because brms is based on Stan, a C++ compiler is required. The program Rtools (available on <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link uri">https://cran.r-project.org/bin/windows/Rtools/</a>) comes with a C++ compiler for Windows. On Mac, you should install Xcode. For further instructions on how to get the compilers running, see the prerequisites section on <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started" class="external-link uri">https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started</a>.</p>
</div>
<div class="section level3">
<h3 id="i-am-new-to-brms-where-can-i-start">I am new to brms. Where can I start?<a class="anchor" aria-label="anchor" href="#i-am-new-to-brms-where-can-i-start"></a>
</h3>
<p>Detailed instructions and case studies are given in the package’s extensive vignettes. See <code>vignette(package = "brms")</code> for an overview. For documentation on formula syntax, families, and prior distributions see <code><a href="reference/brm.html">help("brm")</a></code>.</p>
</div>
<div class="section level3">
<h3 id="where-do-i-ask-questions-propose-a-new-feature-or-report-a-bug">Where do I ask questions, propose a new feature, or report a bug?<a class="anchor" aria-label="anchor" href="#where-do-i-ask-questions-propose-a-new-feature-or-report-a-bug"></a>
</h3>
<p>Questions can be asked on the <a href="https://discourse.mc-stan.org/" class="external-link">Stan forums</a> on Discourse. To propose a new feature or report a bug, please open an issue on <a href="https://github.com/paul-buerkner/brms" class="external-link">GitHub</a>.</p>
</div>
<div class="section level3">
<h3 id="how-can-i-extract-the-generated-stan-code">How can I extract the generated Stan code?<a class="anchor" aria-label="anchor" href="#how-can-i-extract-the-generated-stan-code"></a>
</h3>
<p>If you have already fitted a model, apply the <code>stancode</code> method on the fitted model object. If you just want to generate the Stan code without any model fitting, use the <code>stancode</code> method on your model formula.</p>
</div>
<div class="section level3">
<h3 id="can-i-avoid-compiling-models">Can I avoid compiling models?<a class="anchor" aria-label="anchor" href="#can-i-avoid-compiling-models"></a>
</h3>
<p>When you fit your model for the first time with brms, there is currently no way to avoid compilation. However, if you have already fitted your model and want to run it again, for instance with more draws, you can do this without recompilation by using the <code>update</code> method. For more details see <code><a href="reference/update.brmsfit.html">help("update.brmsfit")</a></code>.</p>
</div>
<div class="section level3">
<h3 id="what-is-the-difference-between-brms-and-rstanarm">What is the difference between brms and rstanarm?<a class="anchor" aria-label="anchor" href="#what-is-the-difference-between-brms-and-rstanarm"></a>
</h3>
<p>The rstanarm package is similar to brms in that it also allows to fit regression models using Stan for the backend estimation. Contrary to brms, rstanarm comes with precompiled code to save the compilation time (and the need for a C++ compiler) when fitting a model. However, as brms generates its Stan code on the fly, it offers much more flexibility in model specification than rstanarm. Also, multilevel models are currently fitted a bit more efficiently in brms. For detailed comparisons of brms with other common R packages implementing multilevel models, see <code>vignette("brms_multilevel")</code> and <code>vignette("brms_overview")</code>.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=brms" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/paul-buerkner/brms/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/paul-buerkner/brms/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2" class="external-link">GPL-2</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing brms</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Paul-Christian Bürkner <br><small class="roles"> Author, maintainer </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://mc-stan.org/" class="external-link"><img src="https://raw.githubusercontent.com/stan-dev/logos/master/logo_tm.png" align="right" width="120" alt="Stan Logo"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul-Christian Bürkner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
