<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Regularized horseshoe priors in brms — horseshoe • brms</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Regularized horseshoe priors in brms — horseshoe"><meta name="description" content="Function used to set up regularized horseshoe priors and related hierarchical
shrinkage priors in brms. The function does not evaluate its arguments
– it exists purely to help set up the model."><meta property="og:description" content="Function used to set up regularized horseshoe priors and related hierarchical
shrinkage priors in brms. The function does not evaluate its arguments
– it exists purely to help set up the model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">brms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.22.12</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/brms_customfamilies.html">Define Custom Response Distributions with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_distreg.html">Estimating Distributional Models with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_families.html">Parameterization of Response Distributions in brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_missings.html">Handle Missing Values with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_monotonic.html">Estimating Monotonic Effects with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_multivariate.html">Estimating Multivariate Models with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_nonlinear.html">Estimating Non-Linear Models with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_phylogenetics.html">Estimating Phylogenetic Multilevel Models with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_threading.html">Running brms models with within-chain parallelization</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/paul-buerkner/brms/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Regularized horseshoe priors in <span class="pkg">brms</span></h1>
      <small class="dont-index">Source: <a href="https://github.com/paul-buerkner/brms/blob/HEAD/R/priors.R" class="external-link"><code>R/priors.R</code></a></small>
      <div class="d-none name"><code>horseshoe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function used to set up regularized horseshoe priors and related hierarchical
shrinkage priors in <span class="pkg">brms</span>. The function does not evaluate its arguments
– it exists purely to help set up the model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">horseshoe</span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  scale_global <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  df_global <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  scale_slab <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  df_slab <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  par_ratio <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  autoscale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>Degrees of freedom of student-t prior of the
local shrinkage parameters. Defaults to <code>1</code>.</p></dd>


<dt id="arg-scale-global">scale_global<a class="anchor" aria-label="anchor" href="#arg-scale-global"></a></dt>
<dd><p>Scale of the student-t prior of the global shrinkage
parameter. Defaults to <code>1</code>.
In linear models, <code>scale_global</code> will internally be
multiplied by the residual standard deviation parameter <code>sigma</code>.</p></dd>


<dt id="arg-df-global">df_global<a class="anchor" aria-label="anchor" href="#arg-df-global"></a></dt>
<dd><p>Degrees of freedom of student-t prior of the
global shrinkage parameter. Defaults to <code>1</code>. If <code>df_global</code>
is greater <code>1</code>, the shape of the prior will no longer resemble
a horseshoe and it may be more appropriately called an hierarchical
shrinkage prior in this case.</p></dd>


<dt id="arg-scale-slab">scale_slab<a class="anchor" aria-label="anchor" href="#arg-scale-slab"></a></dt>
<dd><p>Scale of the Student-t slab. Defaults to <code>2</code>. The
original unregularized horseshoe prior is obtained by setting
<code>scale_slab</code> to infinite, which we can approximate in practice by
setting it to a very large real value.</p></dd>


<dt id="arg-df-slab">df_slab<a class="anchor" aria-label="anchor" href="#arg-df-slab"></a></dt>
<dd><p>Degrees of freedom of the student-t slab.
Defaults to <code>4</code>.</p></dd>


<dt id="arg-par-ratio">par_ratio<a class="anchor" aria-label="anchor" href="#arg-par-ratio"></a></dt>
<dd><p>Ratio of the expected number of non-zero coefficients
to the expected number of zero coefficients. If specified,
<code>scale_global</code> is ignored and internally computed as
<code>par_ratio / sqrt(N)</code>, where <code>N</code> is the total number
of observations in the data.</p></dd>


<dt id="arg-autoscale">autoscale<a class="anchor" aria-label="anchor" href="#arg-autoscale"></a></dt>
<dd><p>Logical; indicating whether the horseshoe
prior should be scaled using the residual standard deviation
<code>sigma</code> if possible and sensible (defaults to <code>TRUE</code>).
Autoscaling is not applied for distributional parameters or
when the model does not contain the parameter <code>sigma</code>.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>Logical (defaults to <code>FALSE</code>); only relevant if the horseshoe
prior spans multiple parameter classes. In this case, only arguments given
in the single instance where <code>main</code> is <code>TRUE</code> will be used.
Arguments given in other instances of the prior will be ignored.
See the Examples section below.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A character string obtained by <code><a href="https://rdrr.io/r/base/match.call.html" class="external-link">match.call()</a></code> with
  additional arguments.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The horseshoe prior is a special shrinkage prior initially proposed by
  Carvalho et al. (2009).
  It is symmetric around zero with fat tails and an infinitely large spike
  at zero. This makes it ideal for sparse models that have
  many regression coefficients, although only a minority of them is non-zero.
  The horseshoe prior can be applied on all population-level effects at once
  (excluding the intercept) by using <code>set_prior("horseshoe(1)")</code>.
  The <code>1</code> implies that the student-t prior of the local shrinkage
  parameters has 1 degrees of freedom. This may, however, lead to an
  increased number of divergent transition in <span class="pkg">Stan</span>.
  Accordingly, increasing the degrees of freedom to slightly higher values
  (e.g., <code>3</code>) may often be a better option, although the prior
  no longer resembles a horseshoe in this case.
  Further, the scale of the global shrinkage parameter plays an important role
  in amount of shrinkage applied. It defaults to <code>1</code>,
  but this may result in too few shrinkage (Piironen &amp; Vehtari, 2016).
  It is thus possible to change the scale using argument <code>scale_global</code>
  of the horseshoe prior, for instance <code>horseshoe(1, scale_global = 0.5)</code>.
  In linear models, <code>scale_global</code> will internally be multiplied by the
  residual standard deviation parameter <code>sigma</code>. See Piironen and
  Vehtari (2016) for recommendations how to properly set the global scale.
  The degrees of freedom of the global shrinkage prior may also be
  adjusted via argument <code>df_global</code>.
  Piironen and Vehtari (2017) recommend to specifying the ratio of the
  expected number of non-zero coefficients to the expected number of zero
  coefficients <code>par_ratio</code> rather than <code>scale_global</code> directly.
  As proposed by Piironen and Vehtari (2017), an additional regularization
  is applied that only affects non-zero coefficients. The amount of
  regularization can be controlled via <code>scale_slab</code> and <code>df_slab</code>.
  To make sure that shrinkage can equally affect all coefficients,
  predictors should be one the same scale.
  Generally, models with horseshoe priors a more likely than other models
  to have divergent transitions so that increasing <code>adapt_delta</code>
  from <code>0.8</code> to values closer to <code>1</code> will often be necessary.
  See the documentation of <code><a href="brm.html">brm</a></code> for instructions
  on how to increase <code>adapt_delta</code>.</p>
<p>The prior does not account for scale differences of the terms it is
  applied on. Accordingly, please make sure that all these terms have a
  comparable scale to ensure that shrinkage is applied properly.</p>
<p>Currently, the following classes support the horseshoe prior: <code>b</code>
  (overall regression coefficients), <code>sds</code> (SDs of smoothing splines),
  <code>sdgp</code> (SDs of Gaussian processes), <code>ar</code> (autoregressive
  coefficients), <code>ma</code> (moving average coefficients), <code>sderr</code> (SD of
  latent residuals), <code>sdcar</code> (SD of spatial CAR structures), <code>sd</code>
  (SD of varying coefficients).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Carvalho, C. M., Polson, N. G., &amp; Scott, J. G. (2009). Handling sparsity via
the horseshoe. Artificial Intelligence and Statistics.
<a href="http://proceedings.mlr.press/v5/carvalho09a" class="external-link">http://proceedings.mlr.press/v5/carvalho09a</a></p>
<p>Piironen J. &amp; Vehtari A. (2017). On the Hyperprior Choice for the Global
Shrinkage Parameter in the Horseshoe Prior. Artificial Intelligence and
Statistics. <a href="https://arxiv.org/pdf/1610.05559v1" class="external-link">https://arxiv.org/pdf/1610.05559v1</a></p>
<p>Piironen, J., and Vehtari, A. (2017). Sparsity information and regularization
in the horseshoe and other shrinkage priors. Electronic Journal of
Statistics. <a href="https://arxiv.org/abs/1707.01694" class="external-link">https://arxiv.org/abs/1707.01694</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="set_prior.html">set_prior</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span><span class="fu">horseshoe</span><span class="op">(</span>df <span class="op">=</span> <span class="fl">3</span>, par_ratio <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b ~ horseshoe(df = 3, par_ratio = 0.1)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specify the horseshoe prior across multiple parameter classes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span><span class="fu">horseshoe</span><span class="op">(</span>df <span class="op">=</span> <span class="fl">3</span>, par_ratio <span class="op">=</span> <span class="fl">0.1</span>, main <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span><span class="fu">horseshoe</span><span class="op">(</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                            prior class coef group resp dpar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  horseshoe(df = 3, par_ratio = 0.1, main = TRUE)     b                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                      horseshoe()    sd                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  nlpar   lb   ub tag source</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;NA&gt; &lt;NA&gt;       user</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;NA&gt; &lt;NA&gt;       user</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul-Christian Bürkner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

