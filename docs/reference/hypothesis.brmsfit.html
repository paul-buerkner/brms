<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Non-Linear Hypothesis Testing — hypothesis.brmsfit • brms</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Non-Linear Hypothesis Testing — hypothesis.brmsfit"><meta name="description" content="Perform non-linear hypothesis testing for all model parameters."><meta property="og:description" content="Perform non-linear hypothesis testing for all model parameters."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">brms</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.22.12</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/brms_customfamilies.html">Define Custom Response Distributions with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_distreg.html">Estimating Distributional Models with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_families.html">Parameterization of Response Distributions in brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_missings.html">Handle Missing Values with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_monotonic.html">Estimating Monotonic Effects with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_multivariate.html">Estimating Multivariate Models with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_nonlinear.html">Estimating Non-Linear Models with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_phylogenetics.html">Estimating Phylogenetic Multilevel Models with brms</a></li>
    <li><a class="dropdown-item" href="../articles/brms_threading.html">Running brms models with within-chain parallelization</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/paul-buerkner/brms/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Non-Linear Hypothesis Testing</h1>
      <small class="dont-index">Source: <a href="https://github.com/paul-buerkner/brms/blob/HEAD/R/hypothesis.R" class="external-link"><code>R/hypothesis.R</code></a></small>
      <div class="d-none name"><code>hypothesis.brmsfit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform non-linear hypothesis testing for all model parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'brmsfit'</span></span>
<span><span class="fu">hypothesis</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">hypothesis</span>,</span>
<span>  class <span class="op">=</span> <span class="st">"b"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">""</span>,</span>
<span>  scope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"standard"</span>, <span class="st">"ranef"</span>, <span class="st">"coef"</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hypothesis</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">hypothesis</span><span class="op">(</span><span class="va">x</span>, <span class="va">hypothesis</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, robust <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An <code>R</code> object. If it is no <code>brmsfit</code> object,
it must be coercible to a <code>data.frame</code>.
In the latter case, the variables used in the <code>hypothesis</code> argument
need to correspond to column names of <code>x</code>, while the rows
are treated as representing posterior draws of the variables.</p></dd>


<dt id="arg-hypothesis">hypothesis<a class="anchor" aria-label="anchor" href="#arg-hypothesis"></a></dt>
<dd><p>A character vector specifying one or more
non-linear hypothesis concerning parameters of the model.</p></dd>


<dt id="arg-class">class<a class="anchor" aria-label="anchor" href="#arg-class"></a></dt>
<dd><p>A string specifying the class of parameters being tested.
Default is "b" for population-level effects.
Other typical options are "sd" or "cor".
If <code>class = NULL</code>, all parameters can be tested
against each other, but have to be specified with their full name
(see also <code><a href="draws-index-brms.html">variables</a></code>)</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Name of a grouping factor to evaluate only
group-level effects parameters related to this grouping factor.</p></dd>


<dt id="arg-scope">scope<a class="anchor" aria-label="anchor" href="#arg-scope"></a></dt>
<dd><p>Indicates where to look for the variables specified in
<code>hypothesis</code>. If <code>"standard"</code>, use the full parameter names
(subject to the restriction given by <code>class</code> and <code>group</code>).
If <code>"coef"</code> or <code>"ranef"</code>, compute the hypothesis for all levels
of the grouping factor given in <code>"group"</code>, based on the
output of <code><a href="coef.brmsfit.html">coef.brmsfit</a></code> and <code><a href="ranef.brmsfit.html">ranef.brmsfit</a></code>,
respectively.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The alpha-level of the tests (default is 0.05;
see 'Details' for more information).</p></dd>


<dt id="arg-robust">robust<a class="anchor" aria-label="anchor" href="#arg-robust"></a></dt>
<dd><p>If <code>FALSE</code> (the default) the mean is used as
the measure of central tendency and the standard deviation as
the measure of variability. If <code>TRUE</code>, the median and the
median absolute deviation (MAD) are applied instead.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>A single numeric value passed to <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code>
to make results reproducible. This is currently only relevant for point
hypotheses that scope over at least two parameters (see Details).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Currently ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code><a href="brmshypothesis.html">brmshypothesis</a></code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Among others, <code>hypothesis</code> computes an evidence ratio
  (<code>Evid.Ratio</code>) for each hypothesis. For a one-sided hypothesis, this
  is just the posterior probability (<code>Post.Prob</code>) under the hypothesis
  against its alternative. That is, when the hypothesis is of the form
  <code>a &gt; b</code>, the evidence ratio is the ratio of the posterior probability
  of <code>a &gt; b</code> and the posterior probability of <code>a &lt; b</code>. In this
  example, values greater than one indicate that the evidence in favor of
  <code>a &gt; b</code> is larger than evidence in favor of <code>a &lt; b</code>. For a
  two-sided (point) hypothesis, the evidence ratio is a Bayes factor between
  the hypothesis and its alternative computed via the Savage-Dickey density
  ratio method. That is the posterior density at the point of interest
  divided by the prior density at that point. Values greater than one
  indicate that evidence in favor of the point hypothesis has increased after
  seeing the data. In order to calculate this Bayes factor, all parameters
  related to the hypothesis must have proper priors and argument
  <code>sample_prior</code> of function <code>brm</code> must be set to <code>"yes"</code>.
  Otherwise <code>Evid.Ratio</code> (and <code>Post.Prob</code>) will be <code>NA</code>.</p>
<p>Please note that the Savage-Dickey density ratio as implemented here provides
  only a very basic test of point hypotheses. It is recommended that you use
  bridge sampling instead (via <code><a href="bayes_factor.brmsfit.html">bayes_factor</a></code> which relies on the
  <span class="pkg">bridgesampling</span> package). When interpreting Bayes factors for point
  hypotheses, make sure that your priors are reasonable and carefully chosen,
  as the result will depend heavily on the priors. In particular, avoid using
  default priors. Additionally, note that point hypotheses that scope over more
  than one parameter (e.g., when testing equality between two parameters) involve
  random sampling of the priors over those parameters (to accommodate the
  the assumption that priors for different parameters are independent of each other).
  This introduces an element of randomness into such hypothesis tests. Consider
  repeating the test to assure results are sufficiently stable, and use the argument
  <code>seed</code> for reproducibility. Finally, note that, for technical reasons, we
  cannot sample from priors of certain parameters classes. Most notably, these include
  overall intercept parameters (prior class <code>"Intercept"</code>) as well as group-level
  coefficients.</p>
<p>For one-sided hypotheses, the <code>Evid.Ratio</code> may sometimes be <code>0</code> or <code>Inf</code> implying very
  small or large evidence, respectively, in favor of the tested hypothesis.
  For one-sided hypotheses pairs, this basically means that all posterior
  draws are on the same side of the value dividing the two hypotheses. In
  that sense, instead of <code>0</code> or <code>Inf,</code> you may rather read it as
  <code>Evid.Ratio</code> smaller <code>1 / S</code> or greater <code>S</code>, respectively,
  where <code>S</code> denotes the number of posterior draws used in the
  computations.</p>
<p>The argument <code>alpha</code> specifies the size of the credible interval
  (i.e., Bayesian confidence interval). For instance, if we tested a
  two-sided hypothesis and set <code>alpha = 0.05</code> (5%) an, the credible
  interval will contain <code>1 - alpha = 0.95</code> (95%) of the posterior
  values. Hence, <code>alpha * 100</code>% of the posterior values will
  lie outside of the credible interval. Although this allows testing of
  hypotheses in a similar manner as in the frequentist null-hypothesis
  testing framework, we strongly argue against using arbitrary cutoffs (e.g.,
  <code>p &lt; .05</code>) to determine the 'existence' of an effect.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="brmshypothesis.html">brmshypothesis</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## define priors</span></span></span>
<span class="r-in"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span><span class="st">"normal(0,2)"</span>, class <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span><span class="st">"student_t(10,0,1)"</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="set_prior.html">set_prior</a></span><span class="op">(</span><span class="st">"student_t(10,0,1)"</span>, class <span class="op">=</span> <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## fit a linear mixed effects models</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="brm.html">brm</a></span><span class="op">(</span><span class="va">time</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">disease</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">age</span><span class="op">|</span><span class="va">patient</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           data <span class="op">=</span> <span class="va">kidney</span>, family <span class="op">=</span> <span class="fu"><a href="brmsfamily.html">lognormal</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           prior <span class="op">=</span> <span class="va">prior</span>, sample_prior <span class="op">=</span> <span class="st">"yes"</span>,</span></span>
<span class="r-in"><span>           control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## perform two-sided hypothesis testing</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">hyp1</span> <span class="op">&lt;-</span> <span class="fu">hypothesis</span><span class="op">(</span><span class="va">fit</span>, <span class="st">"sexfemale = age + diseasePKD"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hyp1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">hypothesis</span><span class="op">(</span><span class="va">fit</span>, <span class="st">"exp(age) - 3 = 0"</span>, alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## perform one-sided hypothesis testing</span></span></span>
<span class="r-in"><span><span class="fu">hypothesis</span><span class="op">(</span><span class="va">fit</span>, <span class="st">"diseasePKD + diseaseGN - 3 &lt; 0"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">hypothesis</span><span class="op">(</span><span class="va">fit</span>, <span class="st">"age &lt; Intercept"</span>,</span></span>
<span class="r-in"><span>           class <span class="op">=</span> <span class="st">"sd"</span>, group  <span class="op">=</span> <span class="st">"patient"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## test the amount of random intercept variance on all variance</span></span></span>
<span class="r-in"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"sd_patient__Intercept^2 / (sd_patient__Intercept^2 +"</span>,</span></span>
<span class="r-in"><span>           <span class="st">"sd_patient__age^2 + sigma^2) = 0"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">hyp2</span> <span class="op">&lt;-</span> <span class="fu">hypothesis</span><span class="op">(</span><span class="va">fit</span>, <span class="va">h</span>, class <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hyp2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## test more than one hypothesis at once</span></span></span>
<span class="r-in"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diseaseGN = diseaseAN"</span>, <span class="st">"2 * diseaseGN - diseasePKD = 0"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">hyp3</span> <span class="op">&lt;-</span> <span class="fu">hypothesis</span><span class="op">(</span><span class="va">fit</span>, <span class="va">h</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hyp3</span>, ignore_prior <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## compute hypotheses for all levels of a grouping factor</span></span></span>
<span class="r-in"><span><span class="fu">hypothesis</span><span class="op">(</span><span class="va">fit</span>, <span class="st">"age = 0"</span>, scope <span class="op">=</span> <span class="st">"coef"</span>, group <span class="op">=</span> <span class="st">"patient"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## use the default method</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">hypothesis</span><span class="op">(</span><span class="va">dat</span>, <span class="st">"b_age &gt; 0"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul-Christian Bürkner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

