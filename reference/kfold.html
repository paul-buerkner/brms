<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>K-Fold Cross-Validation — kfold.brmsfit • brms</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="K-Fold Cross-Validation — kfold.brmsfit" />

<meta property="og:description" content="Perform exact K-fold cross-validation by refitting the model \(K\)
times each leaving out one-\(K\)th of the original data." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.7.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="http://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/paul-buerkner/brms">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>K-Fold Cross-Validation</h1>
    <small class="dont-index">Source: <a href='https://github.com/paul-buerkner/brms/blob/master/R/brmsfit-methods.R'><code>R/brmsfit-methods.R</code></a>, <a href='https://github.com/paul-buerkner/brms/blob/master/R/kfold-helpers.R'><code>R/kfold-helpers.R</code></a></small>
    <div class="hidden name"><code>kfold.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Perform exact K-fold cross-validation by refitting the model \(K\)
times each leaving out one-\(K\)th of the original data.</p>
    
    </div>

    <pre class="usage"><span class='co'># S3 method for brmsfit</span>
<span class='fu'>kfold</span>(<span class='no'>x</span>, <span class='no'>...</span>, <span class='kw'>compare</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>Ksub</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>folds</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>exact_loo</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>resp</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>model_names</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>save_fits</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>kfold</span>(<span class='no'>x</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A fitted model object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>More fitted model objects or further arguments
passed to the underlying post-processing functions.</p></td>
    </tr>
    <tr>
      <th>compare</th>
      <td><p>A flag indicating if the information criteria
of the models should be compared to each other
via <code><a href='compare_ic.html'>compare_ic</a></code>.</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>The number of subsets of equal (if possible) size
into which the data will be partitioned for performing
\(K\)-fold cross-validation. The model is refit <code>K</code> times, each time
leaving out one of the <code>K</code> subsets. If <code>K</code> is equal to the total
number of observations in the data then \(K\)-fold cross-validation is
equivalent to exact leave-one-out cross-validation.</p></td>
    </tr>
    <tr>
      <th>Ksub</th>
      <td><p>Optional number of subsets (of those subsets defined by <code>K</code>) 
to be evaluated. If <code>NULL</code> (the default), \(K\)-fold cross-validation 
will be performed on all subsets. If <code>Ksub</code> is a single integer, 
<code>Ksub</code> subsets (out of all <code>K</code>) subsets will be randomly chosen.
If <code>Ksub</code> consists of multiple integers or a one-dimensional array
(created via <code>as.array</code>) potentially of length one, the corresponding 
subsets will be used. This argument is primarily useful, if evaluation of 
all subsets is infeasible for some reason.</p></td>
    </tr>
    <tr>
      <th>folds</th>
      <td><p>Determines how the subsets are being constructed.
Possible values are <code>NULL</code> (the default), <code>"stratified"</code>,
<code>"balanced"</code>, or <code>"loo"</code>. May also be a vector of length
equal to the number of observations in the data. Alters the way
<code>group</code> is handled. More information is provided in the 'Details'
section.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>Optional name of a grouping variable or factor in the model.
What exactly is done with this variable depends on argument <code>folds</code>.
More information is provided in the 'Details' section.</p></td>
    </tr>
    <tr>
      <th>exact_loo</th>
      <td><p>Deprecated! Please use <code>folds = "loo"</code> instead.</p></td>
    </tr>
    <tr>
      <th>resp</th>
      <td><p>Optional names of response variables. If specified, predictions
are performed only for the specified response variables.</p></td>
    </tr>
    <tr>
      <th>model_names</th>
      <td><p>If <code>NULL</code> (the default) will use model names 
derived from deparsing the call. Otherwise will use the passed 
values as model names.</p></td>
    </tr>
    <tr>
      <th>save_fits</th>
      <td><p>If <code>TRUE</code>, components <code>fits</code> and <code>data</code> are 
added to the returned object. <code>fits</code> stores the cross-validated 
<code>brmsfit</code> objects and the indices of the omitted and predicted 
observations for each fold. <code>data</code> returns the full data frame
used in the cross-validation. Defaults to <code>FALSE</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>kfold</code> returns an object that has a similar structure as the 
  objects returned by the <code>loo</code> and <code>waic</code> methods.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>kfold</code> function performs exact \(K\)-fold
  cross-validation. First the data are partitioned into \(K\) folds 
  (i.e. subsets) of equal (or as close to equal as possible) size by default. 
  Then the model is refit \(K\) times, each time leaving out one of the 
  <code>K</code> subsets. If \(K\) is equal to the total number of observations 
  in the data then \(K\)-fold cross-validation is equivalent to exact 
  leave-one-out cross-validation (to which <code>loo</code> is an efficient 
  approximation). The <code>compare_ic</code> function is also compatible with 
  the objects returned by <code>kfold</code>.</p>  
<p>The subsets can be constructed in multiple different ways:</p><ul>
<li><p>If both <code>folds</code> and <code>group</code> are <code>NULL</code>, the subsets 
  are randomly chosen so that they have equal (or as close to equal as 
  possible) size.</p></li>
<li><p>If <code>folds</code> is <code>NULL</code> but <code>group</code> is specified, the 
  data is split up into subsets, each time omitting all observations of one 
  of the factor levels, while ignoring argument <code>K</code>.</p></li>
<li><p>If <code>folds = "stratified"</code> the subsets are stratified after 
  <code>group</code> using <code><a href='https://www.rdocumentation.org/packages/loo/topics/kfold-helpers'>loo::kfold_split_stratified</a></code>.</p></li>
<li><p>If <code>folds = "balanced"</code> the subsets are balanced by
  <code>group</code> using <code><a href='https://www.rdocumentation.org/packages/loo/topics/kfold-helpers'>loo::kfold_split_balanced</a></code>.</p></li>
<li><p>If <code>folds = "loo"</code> exact leave-one-out cross-validation
  will be performed and <code>K</code> will be ignored. Further, if <code>group</code>
  is specified, all observations corresponding to the factor level of the 
  currently predicted single value are omitted. Thus, in this case, the 
  predicted values are only a subset of the omitted ones.</p></li>
<li><p>If <code>folds</code> is a numeric vector, it must contain one element per 
  observation in the data. Each element of the vector is an integer in 
  <code>1:K</code> indicating to which of the <code>K</code> folds the corresponding 
  observation belongs. There are some convenience functions available in 
  the <span class="pkg">loo</span> package that create integer vectors to use for this purpose 
  (see the Examples section below and also the 
  <a href='https://www.rdocumentation.org/packages/loo/topics/kfold-helpers'>kfold-helpers</a> page).</p></li>
</ul>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='loo.brmsfit.html'>loo</a></code>, <code><a href='reloo.html'>reloo</a></code>, <code><a href='kfold_predict.html'>kfold_predict</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"># NOT RUN {
fit1 <- brm(count ~ zAge + zBase * Trt + 
              (1|patient) + (1|obs),
           data = epilepsy, family = poisson())
# throws warning about some pareto k estimates being too high
(loo1 <- loo(fit1))
# perform 10-fold cross validation
(kfold1 <- kfold(fit1, chains = 1)
# }
<div class='input'> 
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Paul-Christian Bürkner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

